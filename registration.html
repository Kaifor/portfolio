<!DOCTYPE html>

<html lang="en">
<head>
    <meta name="viewport" content="initial-scale=1, width=device-width">
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <link href="stylesHobbies.css" rel="stylesheet">
    <title>David Bronson</title>
</head>
<body>

<div class="blurOverlay"></div>


<div class="contentContainer">

    <div class="boldCentered">SIP Registration</div>
    <div class="bar"></div>
    <div class="blueLeftHeader">Registrar</div>
    <div class="leftDescription">
        A registrar is needed for a VoIP device to connect and authenticate to a VoIP network. Using its IP address, SIP username and password it can authenticate.
    </div>
    <div class="bar"></div>
    <div class="blueLeftHeader">Registration Process</div>
    <div class="leftDescription">
        When a VoIP handset joins a network it will send a SIP Registration request up the registrar address provided to the device.
        From here we will see a few things happen and go into detail on what is occurring.
        <ul>
            <li>VoIP device sends REGISTER</li>
            <li>Registrar responds with 401/407, inside this message we find a Authentication: message contain a couple key items. realm="" and nonce=""</li>
            <li>The VoIP device will respond to the 401/407 again with a REGISTER, this message contains a Nonce Value: "".
                The nonce is generated by taking the SIP username, the realm provided in the 401 and the password by MD5 hashing them together.
                The device then takes the METHOD and Digest URI and does the same MD5 hash.
                Once the device now has a hashed value from sip_username:realm:sip_password it takes that value and hashes it against the value retrived from method:digest_uri.
                That final value is sent up in the Nonce Value in the next registration and the registrar will compare it against its own result to authenticate.
            </li>
        </ul>
        <div></div>
        With this information, lets say the registrar sends back a 403 error indicating the hash value did not match theirs.
        We can get a PCAP and if we know what the SIP username and password are, we can hash these values ourselves to make sure the device is configured and sending the correct information.
    </div>
    <div class="bar"></div>
    <div class="leftHeader">Enter you values from a PCAP into these fields before hitting submit</div>



    <input class="textBoxStyle" type="text" id="username" placeholder="Enter SIP username...">
    <input class="textBoxStyle" type="text" id="password" placeholder="Enter SIP password...">
    <input class="textBoxStyle" type="text" id="realm" placeholder="Enter realm...">
    <input class="textBoxStyle" type="text" id="method" placeholder="Enter METHOD...">
    <input class="textBoxStyle" type="text" id="digestUri" placeholder="Enter Digest URI...">
    <input class="textBoxStyle" type="text" id="nonce" placeholder="Enter 401/407 Nonce...">
    <button class="button" type="button" id="formAnswers">Submit</button>
    <br>
    <div class="leftHeader" id="hashedReturn">Your hashed value is: </div>

</div>
<script src="registerScript.js"></script>







<nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark">
    <div class="container">
        <a
                href="index.html"
                class="navbar-brand mb-0 h1">
            <img class="d-inline-block align-top"
                 src="pics/matt.png"
                 width="30" height="30" />
            Home
        </a>
        <button
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarNav"
                class="navbar-toggler"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse"
             id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle"
                       id="navbarDropdown" role="button"
                       data-bs-toggle="dropdown"
                       aria-expanded="false"
                    >
                        David B
                    </a>
                    <ul class="dropdown-menu"
                        aria-labelledby="navbarDropdown">
                        <li><a href="resume.html"
                               class="dropdown-item">Resume</a>
                        </li>
                        <li><a href="hobbies.html"
                               class="dropdown-item">Hobbies</a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle"
                       id="navbarDropdown1" role="button"
                       data-bs-toggle="dropdown"
                       aria-expanded="false"
                    >
                        SIP
                    </a>
                    <ul class="dropdown-menu"
                        aria-labelledby="navbarDropdown1">
                        <li><a href="registration.html"
                               class="dropdown-item">Registration</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>
<footer>
    <div class="footerCentered">
        Built by David Bronson, 2023.
    </div>

</footer>

</body>
</html>